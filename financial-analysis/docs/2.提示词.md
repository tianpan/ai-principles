# 财务分析程序提示词

## 程序描述

该程序是一个基于Python的财务分析工具，用于处理企业的资产负债表和损益表，生成财务分析报告。程序具有图形用户界面，支持自动识别Excel文件中的财务数据，计算财务指标，生成图表，并输出Word格式的财务分析报告。

## 功能要求

1. 输入处理：
   - 接受xlsx格式的资产负债表和损益表
   - 自动识别表格结构，适应不同格式的Excel文件
   - 从文件名或内容中提取公司名称

2. 数据分析：
   - 计算流动比率、资产负债率、毛利率、净利率等关键财务指标
   - 分析企业财务状况的时间趋势
   - 生成资产负债、收入利润等趋势分析图表

3. 报告生成：
   - 生成包含企业基本信息、财务状况概述、财务指标分析、趋势分析的报告
   - 根据财务指标提供结论和建议
   - 输出为Word格式，包含文字描述和可视化图表

4. 用户界面：
   - 提供图形界面，方便用户选择输入文件和输出位置
   - 显示处理进度
   - 提供操作反馈和错误提示

## 技术实现

1. 文件处理：
   - 使用pandas和openpyxl库读取Excel文件
   - 采用正则表达式和模式匹配识别表格结构

2. 数据分析：
   - 使用pandas和numpy进行数据处理和计算
   - 使用matplotlib生成可视化图表

3. 报告生成：
   - 使用python-docx库创建和格式化Word文档
   - 将生成的图表嵌入到Word文档中

4. 用户界面：
   - 使用PyQt6创建图形用户界面
   - 实现文件选择、参数设置和进度显示功能

## 模块结构

1. Excel处理器 (ExcelProcessor)：
   - 负责读取和解析Excel文件
   - 提取关键财务数据
   - 返回结构化数据供后续分析使用

2. 报告生成器 (ReportGenerator)：
   - 计算财务指标
   - 生成趋势图表
   - 创建和格式化Word文档

3. 主程序 (main)：
   - 创建图形用户界面
   - 处理用户输入
   - 协调Excel处理器和报告生成器的工作

## 用户操作流程

1. 启动程序
2. 选择资产负债表Excel文件
3. 选择损益表Excel文件
4. 指定报告输出位置
5. 设置分析选项（如时间维度）
6. 点击"生成分析报告"按钮
7. 等待处理完成
8. 查看生成的报告

## 异常处理

1. 文件格式错误：提示用户提供有效的Excel文件
2. 数据识别问题：尝试多种模式匹配，如仍失败则提示用户
3. 计算异常：处理零值和缺失值，避免除零错误
4. 报告生成失败：提供错误详情并建议解决方案

## 使用方法

```python
# 启动程序
python financial_analysis/main.py

# 或使用Poetry
poetry run python financial_analysis/main.py
``` 